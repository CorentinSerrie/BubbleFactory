[gd_scene load_steps=24 format=3 uid="uid://bax0pcpnh1j3f"]

[ext_resource type="Script" path="res://machine.gd" id="1_ccy0d"]
[ext_resource type="Script" path="res://factory.gd" id="1_h41np"]
[ext_resource type="Texture2D" uid="uid://byhxn52kmyq6s" path="res://icon.svg" id="2_l52c2"]
[ext_resource type="Texture2D" uid="uid://b6nhj0bdr5vn2" path="res://assets/Placeholders/fishman.png" id="2_n4ilt"]
[ext_resource type="PackedScene" uid="uid://cpy4b4vl4jqcp" path="res://ma_nouvelle_bulle_trop_stylee.tscn" id="2_qchq2"]
[ext_resource type="Texture2D" uid="uid://bxm3226v6vjsn" path="res://assets/Placeholders/JAM_Croquis.jpg" id="5_j8fv6"]
[ext_resource type="Texture2D" uid="uid://oe6h2sj7cpre" path="res://assets/Placeholders/entity.png" id="6_ibmwj"]
[ext_resource type="PackedScene" uid="uid://coa36m2fmcf08" path="res://machine_ui.tscn" id="7_s1267"]
[ext_resource type="Texture2D" uid="uid://buf663yu2r0wt" path="res://assets/Characters/witch_spritesheet.png" id="7_su8h7"]
[ext_resource type="Texture2D" path="res://assets/UI assets/Bubble_factory_endgame_UI_enviro.png" id="8_5ofum"]
[ext_resource type="Texture2D" uid="uid://b5c2patr3dvvs" path="res://assets/Characters/Bubble_factory_endgame_UI_character.png" id="9_txvpo"]
[ext_resource type="Texture2D" uid="uid://bhtj2tqro3asx" path="res://assets/Placeholders/Bubble_factory_startgame_UI.png" id="10_nwnh2"]
[ext_resource type="Texture2D" uid="uid://cchbhuhu8pvhw" path="res://assets/UI assets/new_atlas_texture.tres" id="11_ysgh4"]
[ext_resource type="Theme" uid="uid://b0esmft70vicl" path="res://assets/UI assets/basic_theme.tres" id="12_oixl1"]
[ext_resource type="Texture2D" uid="uid://ntjly63v4fui" path="res://assets/UI assets/UI_toolkit_text_buttons_no_bg.png" id="13_lgq16"]
[ext_resource type="Script" path="res://basic_button.gd" id="14_f6xml"]
[ext_resource type="AudioStream" uid="uid://b8laqoxdeh08p" path="res://assets/SFX/button_validation.mp3" id="16_8bw4s"]

[sub_resource type="AtlasTexture" id="AtlasTexture_ep1v4"]
atlas = ExtResource("7_su8h7")
region = Rect2(0, 0, 698, 889)

[sub_resource type="AtlasTexture" id="AtlasTexture_jgmbu"]
atlas = ExtResource("7_su8h7")
region = Rect2(698, 0, 698, 889)

[sub_resource type="SpriteFrames" id="SpriteFrames_egutm"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_ep1v4")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_jgmbu")
}],
"loop": true,
"name": &"default",
"speed": 5.0
}]

[sub_resource type="ViewportTexture" id="ViewportTexture_p6sn5"]
viewport_path = NodePath("SubViewport")

[sub_resource type="AtlasTexture" id="AtlasTexture_g1le5"]
atlas = ExtResource("13_lgq16")
region = Rect2(358, 278, 1109, 492)

[sub_resource type="AtlasTexture" id="AtlasTexture_181rq"]
atlas = ExtResource("13_lgq16")
region = Rect2(1750, 278, 1109, 492)

[node name="Factory" type="Node2D" node_paths=PackedStringArray("button", "shape_picker", "shape_picker_container", "start_position", "machines", "bubble", "camera", "outro_panel", "outro_score", "circle_center", "circle_in", "circle_out", "presentation_parent")]
script = ExtResource("1_h41np")
button = NodePath("ui/shape_selection/Go button")
shape_picker = NodePath("ui/shape_selection/VBoxContainer/HBoxContainer/shape_picker")
shape_picker_container = NodePath("ui/shape_selection")
start_position = NodePath("start_pos")
machines = [NodePath("machine_1"), NodePath("machine_2"), NodePath("machine_3")]
bubble = NodePath("SS2D_Shwape_Closed2")
camera = NodePath("Camera2D")
outro_panel = NodePath("ui/outro_panel")
outro_score = NodePath("ui/outro_panel/score")
circle_center = NodePath("SubViewport/bubble_presentation")
circle_in = NodePath("SubViewport/bubble_presentation/circle_in")
circle_out = NodePath("SubViewport/bubble_presentation/circle_out")
presentation_parent = NodePath("SubViewport/bubble_presentation")

[node name="Fishman" type="Sprite2D" parent="."]
position = Vector2(-948, 143)
texture = ExtResource("2_n4ilt")

[node name="Entity" type="Sprite2D" parent="."]
position = Vector2(156, -7)
texture = ExtResource("6_ibmwj")

[node name="SS2D_Shwape_Closed2" parent="." instance=ExtResource("2_qchq2")]
position = Vector2(-1359, 107)

[node name="machine_1" type="Node2D" parent="." node_paths=PackedStringArray("entrance_position", "exit_position", "camera_position", "machine_ui")]
position = Vector2(-927, 83)
script = ExtResource("1_ccy0d")
entrance_position = NodePath("entrance")
exit_position = NodePath("exit")
camera_position = NodePath(".")
machine_ui = NodePath("../ui/machine_ui_1")

[node name="entrance" type="Node2D" parent="machine_1"]
position = Vector2(-611, -15)

[node name="exit" type="Node2D" parent="machine_1"]
position = Vector2(509, -2)

[node name="Sprite2D" type="Sprite2D" parent="machine_1"]
visible = false
scale = Vector2(3.755, 3.755)
texture = ExtResource("2_l52c2")

[node name="camera_position" type="Node2D" parent="machine_1"]

[node name="machine_2" type="Node2D" parent="." node_paths=PackedStringArray("entrance_position", "exit_position", "camera_position", "machine_ui")]
position = Vector2(137, 91)
script = ExtResource("1_ccy0d")
entrance_position = NodePath("entrance")
exit_position = NodePath("exit")
camera_position = NodePath(".")
machine_ui = NodePath("../ui/machine_ui_2")

[node name="entrance" type="Node2D" parent="machine_2"]
position = Vector2(-611, -15)

[node name="exit" type="Node2D" parent="machine_2"]
position = Vector2(509, -2)

[node name="Sprite2D" type="Sprite2D" parent="machine_2"]
visible = false
scale = Vector2(3.755, 3.755)
texture = ExtResource("2_l52c2")

[node name="camera_position" type="Node2D" parent="machine_2"]

[node name="machine_3" type="Node2D" parent="." node_paths=PackedStringArray("entrance_position", "exit_position", "camera_position", "machine_ui", "animated_shape")]
position = Vector2(1169, 101)
script = ExtResource("1_ccy0d")
entrance_position = NodePath("entrance")
exit_position = NodePath("exit")
camera_position = NodePath(".")
machine_ui = NodePath("../ui/machine_ui_3")
animation_duration = 1.8
animated_shape = NodePath("witch")

[node name="entrance" type="Node2D" parent="machine_3"]
position = Vector2(-611, -15)

[node name="exit" type="Node2D" parent="machine_3"]
position = Vector2(509, -2)

[node name="camera_position" type="Node2D" parent="machine_3"]

[node name="witch" type="AnimatedSprite2D" parent="machine_3"]
position = Vector2(1, -16)
sprite_frames = SubResource("SpriteFrames_egutm")

[node name="ui" type="Control" parent="."]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="machine_ui_1" parent="ui" instance=ExtResource("7_s1267")]

[node name="machine_ui_2" parent="ui" instance=ExtResource("7_s1267")]
offset_left = 1085.0
offset_top = -19.0
offset_right = 1125.0
offset_bottom = 21.0

[node name="machine_ui_3" parent="ui" instance=ExtResource("7_s1267")]
offset_left = 2136.0
offset_top = -15.0
offset_right = 2176.0
offset_bottom = 25.0

[node name="outro_panel" type="TextureRect" parent="ui"]
visible = false
layout_mode = 0
offset_left = -2150.0
offset_top = -1210.0
offset_right = 2150.0
offset_bottom = 1210.0
texture = ExtResource("8_5ofum")

[node name="TextureRect2" type="TextureRect" parent="ui/outro_panel"]
layout_mode = 0
offset_left = -50.0
offset_top = -200.0
offset_right = 1870.0
offset_bottom = 1134.0
scale = Vector2(2.08, 2.08)
texture = ExtResource("9_txvpo")
stretch_mode = 2

[node name="Button2" type="Button" parent="ui/outro_panel"]
layout_mode = 0
offset_left = 3753.0
offset_top = 2159.0
offset_right = 4153.0
offset_bottom = 2359.0
theme_override_font_sizes/font_size = 100
text = "Restart"

[node name="score" type="Label" parent="ui/outro_panel"]
layout_mode = 0
offset_left = 2602.0
offset_top = 1432.0
offset_right = 3219.0
offset_bottom = 1597.0
theme_override_font_sizes/font_size = 120
text = "score: 50%"

[node name="TextureRect" type="TextureRect" parent="ui/outro_panel"]
layout_mode = 0
offset_left = 2433.0
offset_top = 117.0
offset_right = 3668.0
offset_bottom = 1351.0
texture = SubResource("ViewportTexture_p6sn5")
stretch_mode = 5

[node name="intro_panel" type="TextureRect" parent="ui"]
visible = false
layout_mode = 0
offset_left = -2150.0
offset_top = -1210.0
offset_right = 2150.0
offset_bottom = 1210.0
texture = ExtResource("10_nwnh2")

[node name="Button" type="Button" parent="ui/intro_panel"]
layout_mode = 0
offset_left = 3753.0
offset_top = 2159.0
offset_right = 4153.0
offset_bottom = 2359.0
theme_override_font_sizes/font_size = 100
text = "Next"

[node name="shape_selection" type="TextureRect" parent="ui"]
visible = false
layout_mode = 0
offset_left = -1472.0
offset_top = 469.0
offset_right = 1483.0
offset_bottom = 1190.0
texture = ExtResource("11_ysgh4")
expand_mode = 1

[node name="VBoxContainer" type="VBoxContainer" parent="ui/shape_selection"]
layout_mode = 0
offset_left = 255.0
offset_top = 81.0
offset_right = 2925.0
offset_bottom = 619.0

[node name="HBoxContainer" type="HBoxContainer" parent="ui/shape_selection/VBoxContainer"]
layout_mode = 2

[node name="Label" type="Label" parent="ui/shape_selection/VBoxContainer/HBoxContainer"]
layout_mode = 2
theme_override_colors/font_color = Color(0, 0, 0, 1)
theme_override_font_sizes/font_size = 120
text = "Let's start with a "

[node name="shape_picker" type="OptionButton" parent="ui/shape_selection/VBoxContainer/HBoxContainer"]
layout_mode = 2
theme_override_font_sizes/font_size = 120
selected = 0
item_count = 1
popup/item_0/text = "first"

[node name="Label2" type="Label" parent="ui/shape_selection/VBoxContainer/HBoxContainer"]
layout_mode = 2
theme_override_colors/font_color = Color(0, 0, 0, 1)
theme_override_font_sizes/font_size = 120
text = "  shaped bubble..."

[node name="Label3" type="Label" parent="ui/shape_selection/VBoxContainer"]
layout_mode = 2
theme_override_colors/font_color = Color(0, 0, 0, 1)
theme_override_font_sizes/font_size = 120
text = "We'll see how it goes"

[node name="Go button" type="TextureButton" parent="ui/shape_selection"]
layout_mode = 2
offset_left = 2429.0
offset_top = 406.0
offset_right = 2861.0
offset_bottom = 580.0
theme = ExtResource("12_oixl1")
action_mode = 0
keep_pressed_outside = true
texture_normal = SubResource("AtlasTexture_g1le5")
texture_pressed = SubResource("AtlasTexture_181rq")
ignore_texture_size = true
stretch_mode = 0
script = ExtResource("14_f6xml")

[node name="Click" type="AudioStreamPlayer" parent="ui/shape_selection/Go button"]
stream = ExtResource("16_8bw4s")

[node name="background" type="Sprite2D" parent="."]
z_index = -1
texture = ExtResource("5_j8fv6")

[node name="Camera2D" type="Camera2D" parent="."]
zoom = Vector2(0.446, 0.446)

[node name="SubViewport" type="SubViewport" parent="."]
size = Vector2i(500, 500)

[node name="bubble_presentation" type="Node2D" parent="SubViewport"]
position = Vector2(250, 250)

[node name="background" type="Polygon2D" parent="SubViewport/bubble_presentation"]
polygon = PackedVector2Array(-1500, -1500, 1500, -1500, 1500, 1500, -1500, 1500)

[node name="circle_in" type="Polygon2D" parent="SubViewport/bubble_presentation"]
color = Color(0.141176, 1, 0.223529, 1)
polygon = PackedVector2Array(-185.553, -69.7339, -160.808, -96.0146, -132.653, -120.878, -96.4444, -146.458, -54.0331, -167.428, -31.0798, -174.52, -7.27, -178.464, 17.1651, -178.593, 41.994, -174.241, 66.9853, -164.744, 91.9078, -149.435, 94.7241, -128.864, 99.5959, -109.834, 114.271, -76.2753, 133.465, -48.5253, 154.706, -26.3482, 193.455, 2.22813, 210.762, 11.3354, 104.767, 110.387, -174.366, 118.41, -185.553, -69.7339)

[node name="circle_out" type="Polygon2D" parent="SubViewport/bubble_presentation"]
modulate = Color(1, 0.521569, 1, 1)
clip_children = 1
polygon = PackedVector2Array(182.01, 0, 181.651, 11.4285, 180.575, 22.8119, 178.786, 34.1053, 176.292, 45.2641, 173.102, 56.2443, 169.229, 67.0024, 164.688, 77.4962, 159.497, 87.6841, 153.676, 97.526, 147.249, 106.983, 140.241, 116.018, 132.68, 124.595, 124.595, 132.68, 116.018, 140.241, 106.983, 147.249, 97.526, 153.676, 87.6841, 159.497, 77.4962, 164.688, 67.0024, 169.229, 56.2443, 173.102, 45.2641, 176.292, 34.1053, 178.786, 22.8119, 180.575, 11.4285, 181.651, -7.95592e-06, 182.01, -11.4285, 181.651, -22.8119, 180.575, -34.1053, 178.786, -45.2641, 176.292, -56.2443, 173.102, -67.0024, 169.229, -77.4962, 164.688, -87.6841, 159.497, -97.526, 153.676, -106.983, 147.249, -116.018, 140.241, -124.595, 132.68, -132.68, 124.595, -140.241, 116.018, -147.249, 106.983, -153.676, 97.526, -159.497, 87.6841, -164.688, 77.4962, -169.229, 67.0024, -173.102, 56.2443, -176.292, 45.2641, -178.786, 34.1053, -180.575, 22.8119, -181.651, 11.4285, -182.01, -1.59118e-05, -181.651, -11.4285, -180.575, -22.8119, -178.786, -34.1053, -176.292, -45.2641, -173.102, -56.2443, -169.229, -67.0024, -164.688, -77.4962, -159.497, -87.6841, -153.676, -97.526, -147.249, -106.983, -140.241, -116.018, -132.68, -124.595, -124.595, -132.68, -116.018, -140.241, -106.983, -147.249, -97.526, -153.676, -87.6841, -159.497, -77.4962, -164.688, -67.0025, -169.229, -56.2443, -173.102, -45.2641, -176.292, -34.1053, -178.786, -22.8119, -180.575, -11.4285, -181.651, 2.17045e-06, -182.01, 11.4285, -181.651, 22.8119, -180.575, 34.1053, -178.786, 45.2641, -176.292, 56.2443, -173.102, 67.0025, -169.229, 77.4962, -164.688, 87.6841, -159.497, 97.5259, -153.676, 106.983, -147.249, 116.018, -140.241, 124.595, -132.68, 132.68, -124.595, 140.241, -116.018, 147.249, -106.983, 153.676, -97.526, 159.497, -87.6841, 164.688, -77.4962, 169.229, -67.0024, 173.102, -56.2442, 176.292, -45.2641, 178.786, -34.1053, 180.575, -22.8119, 181.651, -11.4285, 182.01, 3.18237e-05, 5000, 5000, 5000, -5000, -5000, -5000, -5000, 5000, 5000, 5000)

[node name="start_pos" type="Node2D" parent="."]
position = Vector2(-1796, 121)

[connection signal="pressed" from="ui/outro_panel/Button2" to="." method="Restart"]
[connection signal="pressed" from="ui/intro_panel/Button" to="ui/intro_panel" method="hide"]
[connection signal="pressed" from="ui/shape_selection/Go button" to="ui/shape_selection/Go button" method="_on_pressed"]
